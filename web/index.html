<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusBank ATM - Login</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Dev mode banner (hidden by default) -->
    <div id="devBanner" class="dev-banner hidden">‚ö†Ô∏è Server running in DEV MODE (in-memory storage)</div>
    <!-- Background Animation -->
    <div class="background-animation">
        <div class="circle circle-1"></div>
        <div class="circle circle-2"></div>
        <div class="circle circle-3"></div>
        <div class="circle circle-4"></div>
    </div>

    <!-- Login Page -->
    <div class="container" id="loginPage">
        <div class="card login-card">
            <div class="card-header">
                <div class="logo-container">
                    <div class="logo">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="45" fill="#4A90E2"/>
                            <text x="50" y="65" font-size="45" font-weight="bold" fill="white" text-anchor="middle">N</text>
                        </svg>
                    </div>
                </div>
                <!-- Hero visual: bank building + floating cards -->
                <div class="hero-visual" aria-hidden="true">
                    <svg class="bank-building" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" role="img">
                        <rect x="6" y="40" width="188" height="72" rx="6" fill="#0f1724" stroke="#2b3946" stroke-width="2" />
                        <rect x="18" y="52" width="28" height="20" rx="2" fill="#1f2933" />
                        <rect x="52" y="52" width="28" height="20" rx="2" fill="#1f2933" />
                        <rect x="86" y="52" width="28" height="20" rx="2" fill="#1f2933" />
                        <rect x="120" y="52" width="28" height="20" rx="2" fill="#1f2933" />
                        <rect x="154" y="52" width="28" height="20" rx="2" fill="#1f2933" />
                        <rect x="18" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="46" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="74" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="102" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="130" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="158" y="78" width="22" height="24" rx="2" fill="#0b1220" />
                        <rect x="86" y="18" width="28" height="22" rx="3" fill="#4A90E2" />
                        <path d="M10 40 L100 6 L190 40 Z" fill="#0b1220" opacity="0.95"/>
                    </svg>

                    <div class="floating-cards">
                        <div class="floating-card">NEXUS<br><span>**** **** **** 5091</span></div>
                        <div class="floating-card small">ATM<br><span>PIN ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span></div>
                        <div class="floating-card">BANK<br><span>AC ‚Ä¢‚Ä¢‚Ä¢‚Ä¢8744</span></div>
                    </div>
                </div>
                <h1 class="title">NEXUSBANK ATM</h1>
                <p class="subtitle">Secure Banking System</p>
            </div>

            <div class="card-body">
                <!-- New User Section -->
                <div class="new-user-section">
                    <p class="section-label">New to NexusBank?</p>
                    <button class="btn btn-primary btn-block" onclick="showSignup()">
                        <span class="btn-icon">‚ú®</span> CREATE NEW ACCOUNT
                    </button>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <!-- Login Form -->
                <div class="login-section">
                    <p class="section-label">Already have an account? Sign in:</p>
                    
                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" id="cardNumber" class="form-control" placeholder="Enter your card number" maxlength="16">
                    </div>

                    <div class="form-group">
                        <label for="pin">PIN</label>
                        <input type="password" id="pin" class="form-control" placeholder="Enter your PIN" maxlength="4">
                    </div>

                    <div class="button-group">
                        <button class="btn btn-success btn-block" onclick="login()">
                            <span class="btn-icon">üöÄ</span> LOGIN
                        </button>
                        <button class="btn btn-outline btn-block" onclick="showFaceWidget()" title="Login with Face Recognition">
                            <span class="btn-icon">üü¢</span> FACE LOGIN
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="clearLogin()">
                            <span class="btn-icon">üîÑ</span> CLEAR
                        </button>
                    </div>

                    <div id="loginStatus" class="status-message"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transactions Page -->
    <div class="container hidden" id="transactionsPage">
        <div class="card transactions-card">
            <div class="card-header">
                <h2 class="title">TRANSACTION MENU</h2>
                <p class="subtitle">Please select your transaction</p>
            </div>

            <div class="card-body">
                <div class="transaction-grid">
                    <button class="transaction-btn" onclick="showDeposit()">
                        <div class="transaction-icon">üí∞</div>
                        <div class="transaction-text">DEPOSIT</div>
                    </button>

                    <button class="transaction-btn" onclick="showWithdraw()">
                        <div class="transaction-icon">üíµ</div>
                        <div class="transaction-text">CASH WITHDRAWAL</div>
                    </button>

                    <button class="transaction-btn" onclick="showFastCash()">
                        <div class="transaction-icon">‚ö°</div>
                        <div class="transaction-text">FAST CASH</div>
                    </button>

                    <button class="transaction-btn" onclick="showBalance()">
                        <div class="transaction-icon">üìä</div>
                        <div class="transaction-text">BALANCE ENQUIRY</div>
                    </button>

                    <button class="transaction-btn" onclick="showStatement()">
                        <div class="transaction-icon">üìÑ</div>
                        <div class="transaction-text">MINI STATEMENT</div>
                    </button>

                    <button class="transaction-btn" onclick="showPinChange()">
                        <div class="transaction-icon">üîê</div>
                        <div class="transaction-text">CHANGE PIN</div>
                    </button>
                </div>

                <button class="btn btn-danger btn-block mt-20" onclick="logout()">
                    <span class="btn-icon">üëã</span> EXIT
                </button>
            </div>
        </div>
    </div>

    <!-- Deposit Page -->
    <div class="container hidden" id="depositPage">
        <div class="card">
            <div class="card-header">
                <h2 class="title">DEPOSIT CASH</h2>
                <p class="subtitle">Enter the amount you want to deposit</p>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label for="depositAmount">Amount (Rs)</label>
                    <input type="number" id="depositAmount" class="form-control" placeholder="Enter amount">
                </div>
                <div class="button-group">
                    <button class="btn btn-success btn-block" onclick="processDeposit()">
                        <span class="btn-icon">‚úÖ</span> DEPOSIT
                    </button>
                    <button class="btn btn-secondary btn-block" onclick="backToTransactions()">
                        <span class="btn-icon">‚¨ÖÔ∏è</span> BACK
                    </button>
                </div>
                <div id="depositStatus" class="status-message"></div>
            </div>
        </div>
    </div>

    <!-- Withdraw Page -->
    <div class="container hidden" id="withdrawPage">
        <div class="card">
            <div class="card-header">
                <h2 class="title">CASH WITHDRAWAL</h2>
                <p class="subtitle">Enter the amount you want to withdraw</p>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label for="withdrawAmount">Amount (Rs)</label>
                    <input type="number" id="withdrawAmount" class="form-control" placeholder="Enter amount">
                </div>
                <div class="button-group">
                    <button class="btn btn-success btn-block" onclick="processWithdraw()">
                        <span class="btn-icon">‚úÖ</span> WITHDRAW
                    </button>
                    <button class="btn btn-secondary btn-block" onclick="backToTransactions()">
                        <span class="btn-icon">‚¨ÖÔ∏è</span> BACK
                    </button>
                </div>
                <div id="withdrawStatus" class="status-message"></div>
            </div>
        </div>
    </div>

    <!-- Balance Page -->
    <div class="container hidden" id="balancePage">
        <div class="card">
            <div class="card-header">
                <h2 class="title">BALANCE ENQUIRY</h2>
                <p class="subtitle">Your current account balance</p>
            </div>
            <div class="card-body text-center">
                <div class="balance-display">
                    <p class="balance-label">Available Balance</p>
                    <p class="balance-amount">Rs. <span id="balanceAmount">0</span></p>
                </div>
                <button class="btn btn-secondary btn-block mt-20" onclick="backToTransactions()">
                    <span class="btn-icon">‚¨ÖÔ∏è</span> BACK
                </button>
            </div>
        </div>
    </div>

    <!-- Signup Page 1: Personal Details -->
    <div class="container hidden" id="signupPage1">
        <div class="card signup-card">
            <div class="card-header">
                <h2 class="title">NEW ACCOUNT APPLICATION</h2>
                <p class="subtitle">Application Form No: <span id="formNumber"></span></p>
                <p class="subtitle">Page 1: Personal Details</p>
            </div>
            
            <form id="signupForm1" class="card-body signup-form">
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="name" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>Father's Name:</label>
                    <input type="text" id="fatherName" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>Date of Birth:</label>
                    <input type="date" id="dob" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>Gender:</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="gender" value="Male" required> Male</label>
                        <label class="radio-label"><input type="radio" name="gender" value="Female"> Female</label>
                        <label class="radio-label"><input type="radio" name="gender" value="Other"> Other</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Email Address:</label>
                    <input type="email" id="email" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>Marital Status:</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="marital" value="Married" required> Married</label>
                        <label class="radio-label"><input type="radio" name="marital" value="Unmarried"> Unmarried</label>
                        <label class="radio-label"><input type="radio" name="marital" value="Other"> Other</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Address:</label>
                    <input type="text" id="address" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>City:</label>
                    <input type="text" id="city" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label>Pin Code:</label>
                    <input type="text" id="pincode" class="form-input" maxlength="6" pattern="[0-9]{6}" required>
                </div>
                
                <div class="form-group">
                    <label>State:</label>
                    <input type="text" id="state" class="form-input" required>
                </div>
                
                <div id="signup1Status" class="status-message" style="display: none;"></div>
                
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="cancelSignup()">CANCEL</button>
                    <button type="submit" class="btn btn-primary">NEXT</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Signup Page 2: Additional Details -->
    <div class="container hidden" id="signupPage2">
        <div class="card signup-card">
            <div class="card-header">
                <h2 class="title">NEW ACCOUNT APPLICATION</h2>
                <p class="subtitle">Application Form No: <span id="formNumber2"></span></p>
                <p class="subtitle">Page 2: Additional Details</p>
            </div>
            
            <form id="signupForm2" class="card-body signup-form">
                <div class="form-group">
                    <label>Religion:</label>
                    <select id="religion" class="form-input" required>
                        <option value="">Select</option>
                        <option value="Hindu">Hindu</option>
                        <option value="Muslim">Muslim</option>
                        <option value="Sikh">Sikh</option>
                        <option value="Christian">Christian</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Category:</label>
                    <select id="category" class="form-input" required>
                        <option value="">Select</option>
                        <option value="General">General</option>
                        <option value="OBC">OBC</option>
                        <option value="SC">SC</option>
                        <option value="ST">ST</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Income:</label>
                    <select id="income" class="form-input" required>
                        <option value="">Select</option>
                        <option value="Null">Null</option>
                        <option value="< 1,50,000">< 1,50,000</option>
                        <option value="< 2,50,000">< 2,50,000</option>
                        <option value="< 5,00,000">< 5,00,000</option>
                        <option value="Upto 10,00,000">Upto 10,00,000</option>
                        <option value="Above 10,00,000">Above 10,00,000</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Educational Qualification:</label>
                    <select id="education" class="form-input" required>
                        <option value="">Select</option>
                        <option value="Non-Graduate">Non-Graduate</option>
                        <option value="Graduate">Graduate</option>
                        <option value="Post-Graduate">Post-Graduate</option>
                        <option value="Doctorate">Doctorate</option>
                        <option value="Others">Others</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Occupation:</label>
                    <select id="occupation" class="form-input" required>
                        <option value="">Select</option>
                        <option value="Salaried">Salaried</option>
                        <option value="Self-Employed">Self-Employed</option>
                        <option value="Business">Business</option>
                        <option value="Student">Student</option>
                        <option value="Retired">Retired</option>
                        <option value="Others">Others</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>PAN Number:</label>
                    <input type="text" id="pan" class="form-input" maxlength="10" pattern="[A-Z]{5}[0-9]{4}[A-Z]{1}" placeholder="ABCDE1234F" required>
                </div>
                
                <div class="form-group">
                    <label>Aadhar Number:</label>
                    <input type="text" id="aadhar" class="form-input" maxlength="12" pattern="[0-9]{12}" placeholder="123456789012" required>
                </div>
                
                <div class="form-group">
                    <label>Senior Citizen:</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="seniorCitizen" value="Yes" required> Yes</label>
                        <label class="radio-label"><input type="radio" name="seniorCitizen" value="No"> No</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Existing Account:</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="existingAccount" value="Yes" required> Yes</label>
                        <label class="radio-label"><input type="radio" name="existingAccount" value="No"> No</label>
                    </div>
                </div>
                
                <div id="signup2Status" class="status-message" style="display: none;"></div>
                
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="backToSignup1()">BACK</button>
                    <button type="submit" class="btn btn-primary">NEXT</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Signup Page 3: Account Details -->
    <div class="container hidden" id="signupPage3">
        <div class="card signup-card">
            <div class="card-header">
                <h2 class="title">NEW ACCOUNT APPLICATION</h2>
                <p class="subtitle">Application Form No: <span id="formNumber3"></span></p>
                <p class="subtitle">Page 3: Account Details</p>
            </div>
            
            <form id="signupForm3" class="card-body signup-form">
                <div class="form-group">
                    <label>Account Type:</label>
                    <div class="radio-group-vertical">
                        <label class="radio-label"><input type="radio" name="accountType" value="Saving Account" required> Saving Account</label>
                        <label class="radio-label"><input type="radio" name="accountType" value="Fixed Deposit Account"> Fixed Deposit Account</label>
                        <label class="radio-label"><input type="radio" name="accountType" value="Current Account"> Current Account</label>
                        <label class="radio-label"><input type="radio" name="accountType" value="Recurring Deposit Account"> Recurring Deposit Account</label>
                    </div>
                </div>
                
                <div class="card-details-box">
                    <div class="form-group">
                        <label>Card Number:</label>
                        <p class="generated-number" id="generatedCardNumber">XXXX-XXXX-XXXX-XXXX</p>
                        <small>Your 16-digit Card number</small>
                    </div>
                    
                    <div class="form-group">
                        <label>PIN:</label>
                        <p class="generated-number" id="generatedPinNumber">XXXX</p>
                        <small>4-digit password</small>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Services Required:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label"><input type="checkbox" name="services" value="ATM Card" checked> ATM Card</label>
                        <label class="checkbox-label"><input type="checkbox" name="services" value="Internet Banking"> Internet Banking</label>
                        <label class="checkbox-label"><input type="checkbox" name="services" value="Mobile Banking"> Mobile Banking</label>
                        <label class="checkbox-label"><input type="checkbox" name="services" value="EMAIL Alerts"> EMAIL Alerts</label>
                        <label class="checkbox-label"><input type="checkbox" name="services" value="Cheque Book"> Cheque Book</label>
                        <label class="checkbox-label"><input type="checkbox" name="services" value="E-Statement"> E-Statement</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="declaration-label">
                        <input type="checkbox" id="declaration" required>
                        I hereby declare that the above entered details are correct to the best of my knowledge.
                    </label>
                </div>
                
                <!-- Face ID Capture Section -->
                <div class="form-group">
                    <label>üì∏ Capture Face ID (Optional - Recommended for Secure Login):</label>
                    <div class="face-capture-box">
                        <video id="signupVideo" width="320" height="240" autoplay playsinline style="border: 2px solid #ddd; border-radius: 8px; display: none;"></video>
                        <canvas id="signupCanvas" style="display: none;"></canvas>
                        <img id="signupFacePreview" style="max-width: 320px; border: 2px solid #ddd; border-radius: 8px; display: none;" alt="Face preview">
                        <div class="button-group" style="margin-top: 10px;">
                            <button type="button" class="btn btn-primary" id="startSignupCamera" onclick="startSignupCamera()">Start Camera</button>
                            <button type="button" class="btn btn-secondary" id="captureSignupFace" onclick="captureSignupFace()" disabled>Capture Face</button>
                            <button type="button" class="btn btn-secondary" id="retakeSignupFace" onclick="retakeSignupFace()" style="display: none;">Retake</button>
                            <button type="button" class="btn btn-warning" id="skipFaceId" onclick="if(typeof skipFaceId === 'function') { skipFaceId(); } else { alert('Function not loaded'); }">Skip Face ID</button>
                        </div>
                        <p id="signupFaceStatus" style="margin-top: 10px; color: #666; font-size: 14px;">
                            üí° <strong>Note:</strong> Face ID adds extra security to your account. You can skip it and add later.
                        </p>
                    </div>
                </div>
                
                <div id="signup3Status" class="status-message" style="display: none;"></div>
                
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="backToSignup2()">BACK</button>
                    <button type="button" class="btn btn-secondary" onclick="cancelSignup()">CANCEL</button>
                    <button type="submit" class="btn btn-primary">SUBMIT</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/app.js"></script>
    <!-- Face Recognition Widget -->
    <div id="faceWidget" class="face-widget container hidden">
        <div class="card face-card">
            <div class="card-header">
                <h2 class="title">Face Recognition</h2>
                <p class="subtitle">Use your webcam or upload an image</p>
            </div>

            <div class="card-body">
                <div class="face-controls">
                    <div class="camera-area">
                        <video id="video" autoplay playsinline></video>
                        <canvas id="captureCanvas" style="display:none"></canvas>
                    </div>

                    <div class="controls">
                        <button id="startCameraBtn" class="btn btn-primary">Start Camera</button>
                        <button id="captureBtn" class="btn btn-success" disabled>Capture</button>
                        <button id="stopCameraBtn" class="btn btn-secondary" disabled>Stop Camera</button>
                        <label class="file-upload btn btn-outline">Upload
                            <input id="fileInput" type="file" accept="image/*" style="display:none">
                        </label>
                    </div>
                </div>

                <div class="preview-area">
                    <h4>Preview</h4>
                    <img id="previewImg" alt="preview" src="" />
                </div>

                <div class="result-area">
                    <h4>Detection Result</h4>
                    <pre id="faceResult">No detection yet</pre>
                </div>

                <div class="button-group mt-10">
                    <button class="btn btn-outline" onclick="sendSampleImage()">Test Sample Image</button>
                    <button class="btn btn-secondary" onclick="hideFaceWidget()">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

